<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rogar's Impostor - Local Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: #ffffff; min-height: 100vh; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .btn-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); transition: all 0.2s ease; }
        .btn-outline-indigo { border: 2px solid #6366f1; background: transparent; transition: all 0.2s ease; }
        .btn-outline-indigo:hover { background: rgba(99, 102, 241, 0.1); box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
        .perspective-1000 { perspective: 1000px; }
        .card-inner { transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; cursor: pointer; }
        .is-flipped { transform: rotateY(180deg); }
        .backface-hidden { backface-visibility: hidden; }
        .animate-pulse-soft { animation: pulse-soft 2s infinite; }
        @keyframes pulse-soft { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }
    </style>
</head>
<body class="p-4 flex flex-col items-center">

    <!-- MENU PRINCIPAL (HUB) -->
    <div id="view-hub" class="w-full max-w-md py-12 flex flex-col items-center space-y-8 fade-in">
        <header class="text-center">
            <h1 class="text-5xl font-black italic tracking-tighter leading-none mb-2 text-white">ROGAR'S<br><span class="text-indigo-500">IMPOSTOR</span></h1>
            <p class="text-[10px] uppercase tracking-[0.2em] text-gray-500 font-bold">Local Party Game</p>
        </header>

        <div class="w-full glass p-8 rounded-3xl space-y-6 shadow-2xl border-white/5">
            <div class="text-center">
                <h3 class="text-xl font-black uppercase italic tracking-tighter text-indigo-400">Mode Local</h3>
            </div>
            
            <div class="space-y-6">
                <!-- Nombre de Joueurs -->
                <div>
                    <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2 text-center">Nombre de Joueurs</label>
                    <div class="flex items-center justify-between bg-white/5 p-2 rounded-xl">
                        <button onclick="changeVal('players', -1)" class="w-12 h-12 glass rounded-lg font-black text-xl hover:bg-white/10 active:scale-90 transition-all">-</button>
                        <span id="val-players" class="text-3xl font-black">4</span>
                        <button onclick="changeVal('players', 1)" class="w-12 h-12 glass rounded-lg font-black text-xl hover:bg-white/10 active:scale-90 transition-all">+</button>
                    </div>
                </div>

                <!-- Nombre d'Imposteurs -->
                <div>
                    <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2 text-center">Nombre d'Imposteurs</label>
                    <div class="flex items-center justify-between bg-white/5 p-2 rounded-xl">
                        <button onclick="changeVal('impostors', -1)" class="w-12 h-12 glass rounded-lg font-black text-xl hover:bg-white/10 active:scale-90 transition-all">-</button>
                        <span id="val-impostors" class="text-3xl font-black">1</span>
                        <button onclick="changeVal('impostors', 1)" class="w-12 h-12 glass rounded-lg font-black text-xl hover:bg-white/10 active:scale-90 transition-all">+</button>
                    </div>
                </div>

                <!-- Option Indice -->
                <div class="flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5">
                    <div class="flex flex-col">
                        <span class="text-xs font-black uppercase tracking-wider text-gray-300">Indice pour l'Imposteur</span>
                        <span class="text-[8px] text-gray-500 uppercase font-bold italic">Donne la cat√©gorie du mot des civils</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="opt-hints" class="sr-only peer" checked>
                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                    </label>
                </div>
            </div>

            <div class="space-y-3">
                <button onclick="showNameConfig()" class="w-full btn-gradient p-5 rounded-2xl font-black uppercase shadow-xl hover:scale-[1.02] active:scale-95 transition-all text-lg tracking-tight">
                    Jouer en Local
                </button>
                
                <button onclick="goToOnline()" class="w-full btn-outline-indigo p-4 rounded-2xl font-black uppercase text-sm tracking-widest flex items-center justify-center gap-3">
                    <span>üåê</span> Mode Online
                </button>
            </div>
        </div>
    </div>

    <!-- CONFIG DES NOMS -->
    <div id="view-names" class="w-full max-w-md hidden fade-in py-12">
        <div class="glass p-8 rounded-3xl space-y-6 shadow-2xl border-white/5">
            <div class="text-center">
                <h3 class="text-xl font-black uppercase italic tracking-tighter text-indigo-400">Noms des Joueurs</h3>
            </div>
            <div id="names-list" class="space-y-3 max-h-80 overflow-y-auto pr-2 custom-scrollbar"></div>
            <div class="flex gap-3">
                <button onclick="backToHub()" class="flex-1 glass p-4 rounded-xl font-bold text-xs uppercase opacity-60">Retour</button>
                <button onclick="startGame()" class="flex-[2] btn-gradient p-4 rounded-xl font-black uppercase shadow-lg text-sm">C'est parti !</button>
            </div>
        </div>
    </div>

    <!-- CONTENEUR DE JEU -->
    <div id="game-container" class="w-full max-w-md hidden fade-in">
        <div id="game-content"></div>
    </div>

    <!-- MODAL TENTATIVE ULTIME -->
    <div id="guess-modal" class="fixed inset-0 bg-slate-950/90 backdrop-blur-md z-[70] flex items-center justify-center p-6 hidden">
        <div class="w-full max-w-xs glass p-8 rounded-[2.5rem] border-white/10 text-center space-y-6 fade-in">
            <div class="space-y-2">
                <p class="text-[10px] font-black text-indigo-400 uppercase tracking-widest">Derni√®re chance</p>
                <h3 class="text-2xl font-black uppercase italic tracking-tight text-white">Quel est le mot des civils ?</h3>
                <p class="text-[9px] text-red-500 font-bold uppercase italic">‚ö†Ô∏è Si tu te trompes, tu es √©limin√© !</p>
            </div>
            <input type="text" id="guess-input" placeholder="Ecris le mot ici..." class="w-full bg-white/5 p-4 rounded-2xl border border-white/10 outline-none font-bold text-center uppercase tracking-widest focus:border-indigo-500 transition-all">
            <div class="flex flex-col gap-3">
                <button onclick="submitGuess()" class="w-full btn-gradient p-4 rounded-2xl font-black uppercase text-sm shadow-lg">Valider</button>
                <button onclick="closeGuess()" class="w-full glass p-4 rounded-2xl font-black uppercase text-xs text-gray-400">Annuler</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE CONFIRMATION D'√âJECTION -->
    <div id="confirm-modal" class="fixed inset-0 bg-slate-950/80 backdrop-blur-sm z-[60] flex items-center justify-center p-6 hidden">
        <div class="w-full max-w-xs glass p-8 rounded-[2.5rem] border-white/10 text-center space-y-6 fade-in">
            <div class="space-y-2">
                <p class="text-[10px] font-black text-red-500 uppercase tracking-widest">Confirmation</p>
                <h3 id="confirm-text" class="text-2xl font-black uppercase italic tracking-tight">√âjecter ce joueur ?</h3>
            </div>
            <div class="flex flex-col gap-3">
                <button id="confirm-yes" class="w-full bg-red-600 p-4 rounded-2xl font-black uppercase text-sm shadow-lg hover:bg-red-500 transition-all">√âjecter</button>
                <button onclick="closeConfirm()" class="w-full glass p-4 rounded-2xl font-black uppercase text-xs text-gray-400">Annuler</button>
            </div>
        </div>
    </div>

    <!-- OVERLAY R√âSULTAT ELIMINATION -->
    <div id="overlay" class="fixed inset-0 bg-slate-950/95 backdrop-blur-md z-50 flex items-center justify-center p-6 hidden text-white text-center">
        <div id="overlay-content"></div>
    </div>

    <script>
        let config = { players: 4, impostors: 1, useHints: true };
        let gameState = { players: [], currentStep: 0, phase: 'reveal', secretWord: "" };
        let playerToEliminate = null;

        const wordPairs = [
            { civ: "Lion", hint: "F√©lin sauvage" },
            { civ: "Pizza", hint: "Restauration rapide" },
            { civ: "Avion", hint: "Transport a√©rien" },
            { civ: "Soleil", hint: "Objet c√©leste" },
            { civ: "Football", hint: "Sport de ballon" },
            { civ: "Guitare", hint: "Instrument √† cordes" },
            { civ: "Pomme", hint: "Fruit du verger" },
            { civ: "Paris", hint: "Capitale europ√©enne" },
            { civ: "Stylo", hint: "Fourniture de bureau" },
            { civ: "Chocolat", hint: "Confiserie" }
        ];

        function changeVal(key, delta) {
            config[key] = Math.max(1, Math.min(12, config[key] + delta));
            if (config.impostors >= config.players) config.impostors = config.players - 1;
            document.getElementById(`val-${key}`).innerText = config[key];
        }

        function goToOnline() {
            const onlineUrl = "imposteur_online.html"; 
            window.location.href = onlineUrl;
        }

        function showNameConfig() {
            config.useHints = document.getElementById('opt-hints').checked;
            document.getElementById('view-hub').classList.add('hidden');
            document.getElementById('view-names').classList.remove('hidden');
            
            const list = document.getElementById('names-list');
            list.innerHTML = '';
            for(let i=0; i < config.players; i++) {
                list.innerHTML += `
                    <div class="bg-white/5 p-1 rounded-xl flex items-center border border-white/5">
                        <span class="w-8 text-center text-[10px] font-black text-gray-500">${i+1}</span>
                        <input type="text" id="name-${i}" value="Joueur ${i+1}" class="bg-transparent flex-1 p-3 outline-none font-bold text-sm text-white">
                    </div>
                `;
            }
        }

        function backToHub() {
            document.getElementById('view-names').classList.add('hidden');
            document.getElementById('view-hub').classList.remove('hidden');
        }

        function startGame() {
            document.getElementById('view-names').classList.add('hidden');
            document.getElementById('game-container').classList.remove('hidden');

            const pair = wordPairs[Math.floor(Math.random() * wordPairs.length)];
            const players = [];
            const impostorIndices = [];

            while(impostorIndices.length < config.impostors) {
                const r = Math.floor(Math.random() * config.players);
                if(!impostorIndices.includes(r)) impostorIndices.push(r);
            }

            for(let i=0; i < config.players; i++) {
                const isImpo = impostorIndices.includes(i);
                const customName = document.getElementById(`name-${i}`).value || `Joueur ${i+1}`;
                players.push({
                    id: i,
                    name: customName,
                    role: isImpo ? 'Imposteur' : 'Civil',
                    word: isImpo ? '???' : pair.civ,
                    hint: pair.hint,
                    eliminated: false
                });
            }

            gameState = { players, currentStep: 0, phase: 'reveal', secretWord: pair.civ };
            render();
        }

        function render() {
            const container = document.getElementById('game-content');
            
            if (gameState.phase === 'reveal') {
                const p = gameState.players[gameState.currentStep];
                container.innerHTML = `
                    <div class="space-y-8 text-center fade-in">
                        <div class="space-y-1">
                            <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest">√âtape 1 : Secret</p>
                            <h2 class="text-4xl font-black uppercase text-indigo-400">${p.name}</h2>
                        </div>

                        <div class="perspective-1000 w-full h-80 mx-auto" onclick="this.querySelector('.card-inner').classList.toggle('is-flipped')">
                            <div class="card-inner relative w-full h-full shadow-2xl">
                                <div class="backface-hidden absolute inset-0 glass rounded-[2.5rem] flex flex-col items-center justify-center border-2 border-dashed border-white/20">
                                    <div class="w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mb-4 text-4xl">üÉè</div>
                                    <p class="text-xs font-black uppercase tracking-tighter animate-pulse-soft">Appuie pour voir ta carte</p>
                                </div>
                                <div class="backface-hidden absolute inset-0 ${p.role === 'Imposteur' ? 'bg-red-600' : 'bg-indigo-600'} rounded-[2.5rem] flex flex-col items-center justify-center p-8" style="transform: rotateY(180deg)">
                                    <p class="text-[10px] font-bold uppercase opacity-60 mb-2">Ton R√¥le</p>
                                    <h3 class="font-black text-3xl uppercase mb-6">${p.role}</h3>
                                    <div class="bg-black/20 p-6 rounded-2xl w-full border border-white/10 mb-4">
                                        <p class="text-[10px] font-bold uppercase opacity-50 mb-1">Mot secret</p>
                                        <p class="text-3xl font-black uppercase tracking-widest">${p.word}</p>
                                    </div>
                                    
                                    ${config.useHints && p.role === 'Imposteur' ? `
                                        <div class="bg-white/10 p-3 rounded-xl border border-white/20 w-full">
                                            <p class="text-[9px] font-black uppercase tracking-widest text-white/70 mb-1 italic">Cat√©gorie des civils</p>
                                            <p class="text-sm font-black tracking-tight uppercase">${p.hint}</p>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>

                        <button onclick="nextStep()" class="w-full glass p-5 rounded-2xl font-black uppercase text-sm border-white/10">
                            C'est bon !
                        </button>
                    </div>
                `;
            } else if (gameState.phase === 'vote') {
                const alive = gameState.players.filter(p => !p.eliminated);
                container.innerHTML = `
                    <div class="space-y-6 fade-in text-center">
                        <h2 class="text-4xl font-black text-red-500 italic uppercase">VOTEZ !</h2>
                        <div class="grid grid-cols-1 gap-3">
                            ${alive.map(p => `
                                <button onclick="askEliminate(${p.id})" class="p-5 glass rounded-2xl font-black text-lg uppercase flex justify-between items-center hover:border-indigo-500 transition-all">
                                    <span>${p.name}</span>
                                    <span class="text-[10px] bg-white/10 px-3 py-1 rounded-full">√âliminer</span>
                                </button>
                            `).join('')}
                        </div>
                        
                        <div class="pt-4">
                            <button onclick="openGuess()" class="w-full bg-white/5 border border-dashed border-white/20 p-4 rounded-2xl text-[10px] font-black uppercase tracking-[0.3em] hover:bg-white/10 transition-all text-gray-400">
                                üéØ Tentative Ultime
                            </button>
                            <p class="text-[8px] text-gray-600 uppercase mt-2 italic">Une seule chance : Gagne ou sois √âlimin√©</p>
                        </div>
                    </div>
                `;
            }
        }

        function nextStep() {
            gameState.currentStep++;
            if (gameState.currentStep >= gameState.players.length) {
                gameState.phase = 'vote';
            }
            render();
        }

        function askEliminate(id) {
            const p = gameState.players.find(x => x.id === id);
            playerToEliminate = id;
            document.getElementById('confirm-text').innerText = `√âjecter ${p.name} ?`;
            document.getElementById('confirm-modal').classList.remove('hidden');
            document.getElementById('confirm-yes').onclick = () => {
                closeConfirm();
                eliminate(playerToEliminate);
            };
        }

        function closeConfirm() {
            document.getElementById('confirm-modal').classList.add('hidden');
        }

        function openGuess() {
            document.getElementById('guess-input').value = "";
            document.getElementById('guess-modal').classList.remove('hidden');
            setTimeout(() => document.getElementById('guess-input').focus(), 300);
        }

        function closeGuess() {
            document.getElementById('guess-modal').classList.add('hidden');
        }

        function submitGuess() {
            const val = document.getElementById('guess-input').value.trim().toLowerCase();
            const secret = gameState.secretWord.toLowerCase();
            closeGuess();

            if (val === secret) {
                showEnd('Imposteurs', true);
            } else {
                // √âlimination de l'imposteur qui a rat√© sa tentative
                // On prend le premier imposteur vivant par d√©faut pour la d√©mo locale
                const currentImpo = gameState.players.find(p => p.role === 'Imposteur' && !p.eliminated);
                
                const overlay = document.getElementById('overlay');
                const content = document.getElementById('overlay-content');
                overlay.classList.remove('hidden');
                
                content.innerHTML = `
                    <h2 class="text-4xl font-black uppercase text-red-500 mb-2">MAUVAIS MOT !</h2>
                    <p class="text-gray-400 font-bold uppercase text-xs mb-6">Ce n'√©tait pas "${val.toUpperCase()}"</p>
                    <p class="text-white font-black uppercase text-sm italic">L'imposteur est √©limin√© pour son √©chec !</p>
                `;
                
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    if(currentImpo) eliminate(currentImpo.id);
                }, 3000);
            }
        }

        function eliminate(id) {
            const p = gameState.players.find(x => x.id === id);
            p.eliminated = true;

            const overlay = document.getElementById('overlay');
            const content = document.getElementById('overlay-content');
            
            overlay.classList.remove('hidden');
            content.innerHTML = `
                <p class="text-gray-500 font-bold uppercase mb-2">${p.name} √©tait...</p>
                <h2 class="text-6xl font-black uppercase mb-4 ${p.role === 'Imposteur' ? 'text-red-500' : 'text-indigo-400'}">${p.role}</h2>
                <div class="text-4xl">${p.role === 'Imposteur' ? '‚ùå' : 'üòá'}</div>
            `;

            setTimeout(() => {
                overlay.classList.add('hidden');
                checkVictory();
            }, 3000);
        }

        function checkVictory() {
            const remImpo = gameState.players.filter(p => p.role === 'Imposteur' && !p.eliminated).length;
            const remCiv = gameState.players.filter(p => p.role === 'Civil' && !p.eliminated).length;

            if (remImpo === 0) showEnd('Civils');
            else if (remCiv <= remImpo) showEnd('Imposteurs');
            else render();
        }

        function showEnd(winner, viaGuess = false) {
            const container = document.getElementById('game-content');
            container.innerHTML = `
                <div class="text-center space-y-10 py-10 fade-in">
                    <div class="space-y-2">
                        <h1 class="text-6xl font-black italic ${winner === 'Civils' ? 'text-indigo-500' : 'text-red-500'}">
                            VICTOIRE<br>${winner.toUpperCase()}
                        </h1>
                        ${viaGuess ? `<p class="text-[10px] font-black uppercase text-red-400 tracking-widest">Le mot a √©t√© d√©couvert !</p>` : ''}
                    </div>
                    
                    <div class="space-y-2">
                        ${gameState.players.map(p => `
                            <div class="flex justify-between p-3 glass rounded-xl border-white/5 text-[10px] font-black uppercase">
                                <span class="${p.eliminated ? 'opacity-30 line-through' : ''}">${p.name}</span>
                                <span class="${p.role === 'Imposteur' ? 'text-red-500' : 'text-indigo-400'}">${p.role} (${p.role === 'Civil' ? p.word : p.hint})</span>
                            </div>
                        `).join('')}
                    </div>
                    <button onclick="location.reload()" class="w-full btn-gradient p-5 rounded-2xl font-black uppercase">Nouveau Jeu</button>
                </div>
            `;
        }
    </script>
</body>
</html>
